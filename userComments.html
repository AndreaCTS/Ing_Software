<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comentarios y Calificaciones</title>
<link rel="stylesheet" href="styles/userCommentsStyle.css">
</head>
<body>
  <header>
   <h1>Explora Comentarios y Calificaciones De 
   La Seguridad En Chapinero </h1>
  </header>

  <div class="container">
    <h2>Comentarios</h2>
    <label for="filtroZona">Filtrar por zona de riesgo:</label>
    <select id="filtroZona">
      <option value="todos">Todos</option>
      <option value="alta">Alta</option>
      <option value="media">Media</option>
      <option value="baja">Baja</option>
    </select>
    
    <label for="filtroCalificacion">Filtrar por calificación:</label>
    <select id="filtroCalificacion">
      <option value="todos">Todos</option>
      <option value="5">★★★★★</option>
      <option value="4">★★★★☆</option>
      <option value="3">★★★☆☆</option>
      <option value="2">★★☆☆☆</option>
      <option value="1">★☆☆☆☆</option>
    </select>

    <div class="comments">
        <div class="comment">
            <h3>Usuario 1</h3>
            <p>¡Este es un comentario genial! Me encanta este contenido.</p>
            <div class="stars">Calificación: ★★★★☆</div>
            <button class="edit-button">Editar</button>
            <select class="edit-rating" style="display:none;">
                <option value="5">★★★★★</option>
                <option value="4">★★★★☆</option>
                <option value="3">★★★☆☆</option>
                <option value="2">★★☆☆☆</option>
                <option value="1">★☆☆☆☆</option>
            </select>
        </div>

        <div class="comment">
            <h3>Usuario 2</h3>
            <p>No estoy seguro de esto. Podría ser mejor.</p>
            <div class="stars">Calificación: ★★☆☆☆</div>
            <button class="edit-button">Editar</button>
            <select class="edit-rating" style="display:none;">
                <option value="5">★★★★★</option>
                <option value="4">★★★★☆</option>
                <option value="3">★★★☆☆</option>
                <option value="2">★★☆☆☆</option>
                <option value="1">★☆☆☆☆</option>
            </select>
        </div>
    </div>
    <h2>Deja tu Comentario</h2>
    <form id="comment-form">
      <label for="username">Nombre de Usuario:</label>
      <input type="text" id="username" name="username" required>

      <label for="comment">Comentario:</label>
      <textarea id="comment" name="comment" rows="4" required></textarea>

      <label for="rating">Calificación:</label>
      <select id="rating" name="rating" required>
        <option value="5">★★★★★</option>
        <option value="4">★★★★☆</option>
        <option value="3">★★★☆☆</option>
        <option value="2">★★☆☆☆</option>
        <option value="1">★☆☆☆☆</option>
      </select>

      <button type="submit">Enviar Comentario</button>
    </form>
    
    <script>
        const commentForm = document.getElementById('comment-form');
        const newCommentsContainer = document.querySelector('.comments');
      
        commentForm.addEventListener('submit', (e) => {
          e.preventDefault();
      
          // Obtener datos del formulario
          const username = e.target.querySelector('#username').value;
          const commentText = e.target.querySelector('#comment').value;
          const rating = e.target.querySelector('#rating').value;
      
          // Crear un nuevo comentario
          const newComment = document.createElement('div');
          newComment.classList.add('comment');
      
          // Construir la estructura del comentario
          newComment.innerHTML = `
            <h3>${username}</h3>
            <p>${commentText}</p>
            <div class="stars">Calificación: <span class="stars">${'★'.repeat(rating)}${'☆'.repeat(5 - rating)}</span></div>
            <button class="edit-button">Editar</button>
            <select class="edit-rating" style="display:none;">
              <option value="5">★★★★★</option>
              <option value="4">★★★★☆</option>
              <option value="3">★★★☆☆</option>
              <option value="2">★★☆☆☆</option>
              <option value="1">★☆☆☆☆</option>
            </select>
          `;
            
          // Agregar el nuevo comentario al contenedor
          newCommentsContainer.appendChild(newComment);
      
          // Limpiar el formulario
          e.target.reset();
        });
      
        // Agregar manejo de eventos para la edición de calificación
        const comments = document.querySelectorAll('.comment');
      
        comments.forEach((comment) => {
          const editButton = comment.querySelector('.edit-button');
          const editRating = comment.querySelector('.edit-rating');
          const stars = comment.querySelector('.stars');
      
          editButton.addEventListener('click', () => {
            editRating.style.display = 'inline-block';
            editRating.value = stars.textContent.length;
            stars.style.display = 'none';
          });
      
          editRating.addEventListener('change', () => {
            stars.style.display = 'inline-block';
            stars.textContent = '★'.repeat(editRating.value);
            editRating.style.display = 'none';
          });

          
          const filtroCalificacion = document.getElementById('filtroCalificacion');

          filtroCalificacion.addEventListener('change', () => {
            const selectedRating = filtroCalificacion.value;

            // Obtener todos los comentarios
            const comments = document.querySelectorAll('.comment');

            // Mostrar u ocultar comentarios según la calificación seleccionada
            comments.forEach((comment) => {
              const stars = comment.querySelector('.stars').textContent.length;
        
              if (selectedRating === 'todos' || stars === parseInt(selectedRating)) {
                comment.style.display = 'block';
              } else {
                comment.style.display = 'none';
              }
            });
          });
          

        });
    </script>
      
    
  </div>
